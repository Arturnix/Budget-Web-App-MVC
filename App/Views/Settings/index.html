{% extends 'base.html' %} {% block title %}Twój bilans{% endblock %} 

{% block footer %}

<script src="/js/hideShowPasswordEdit.js"></script>
<script src="/js/app.js"></script>

<script>
  $(document).ready(function () {
    /**
     * Validate the form
     */

    $("#formEditUserPassword").validate({
      rules: {
        newUserPassword: {
          required: true,
          minlength: 6,
          maxlength: 20,
          validPassword: true,
        },
      },
      messages: {
        newUserPassword: {
          required: "Pole wymagane",
          minlength: "Minimalna długość hasła to 6 znaków",
          maxlength: "Maksymalna długość hasła to 20 znaków",
          validPassword: "Hasło musi zawierać przynajmniej 1 literę i 1 cyfrę",
        },
      },

      errorClass: "text-danger",
      errorPlacement: function ($error, $element) {
        var name = $element.attr("name");

        $("#error" + name).append($error);
      },
    });
  });

  function onSubmit(token) {
    document.getElementById("formEditUserPassword").submit();
  }
</script>

<footer>
  © 2023
  <img src="/img/favicon.ico" alt="Arturnix icon" /> Arturnix.
</footer>

{% endblock %}

{% block body %} {% if current_user %}

  </head>

<header>
  <div id="title">
    <img
      class="header-budget-img"
      id="budgetImg"
      src="/img/budget.png"
      alt="budget-img"
    />

    <h1 class="header-title">Zaplanuj swój budżet i zacznij oszczędzać!</h1>
  </div>

  <nav id="navigation-bar" class="navbar navbar-expand-lg navbar-light">
    <button
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbarNavAltMarkup"
      aria-controls="navbarNavAltMarkup"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="/home/index"
            ><i class="nav-icon fa-solid fa-house-chimney"></i>Strona główna</a
          >
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/incomes/index"
            ><i class="nav-icon fa-solid fa-sack-dollar"></i>Dodaj przychód</a
          >
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/expenses/index"
            ><i class="nav-icon fa-solid fa-cash-register"></i>Dodaj wydatek</a
          >
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/balances/index"
            ><i class="nav-icon fa-solid fa-scale-unbalanced"></i>Przeglądaj
            bilans</a
          >
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#"
            ><i class="nav-icon fa-solid fa-screwdriver-wrench"></i
            >Ustawienia</a
          >
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/logout"
            ><i class="nav-icon fa-solid fa-arrow-up-right-from-square"></i
            >Wyloguj się</a
          >
        </li>
      </ul>
    </div>
  </nav>
</header>

<!-- Edit names -->
<!-- Modal edit income name -->
<div class="modal fade" id="editIncomeName" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Edytuj nazwę kategorii przychodu</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/editIncomeName" method="post">

          <div class="form-group-modal mt-4 mb-4">
            <label>Podaj nową nazwę:</label>
            <div class="input-container">
              <input
                id="newIncomeName"
                name="newIncomeName"
                type="text"
                class="form-control mb-2 mt-2"
                required
              />
            </div>
          </div>

          <div class="form-group-modal mt-4 mb-4">
            <label>Wybierz kategorię do zmiany nazwy:</label>
            <div class="input-container">
              
            <ul>
              {% for incomeCategory in incomesCategories %}
              <div class="form-check">
                <input class="form-check-input" type="radio" value="{{ incomeCategory.id }}" name="editIncomeName" id="income{{ incomeCategory.id }}">
                <label class="form-check-label" for="income{{ incomeCategory.id }}">
                  {{ incomeCategory.name }}
                </label>
              </div>
              {% endfor %}
            </ul>
            
            </div>
          </div>

      </div>
      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Zmień nazwę
          </button>
          
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

<!-- Modal edit expense name -->
<div class="modal fade" id="editExpanseName" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Edytuj nazwę kategorii wydatku</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/editExpenseName" method="post">

          <div class="form-group-modal mt-4 mb-4">
            <label>Podaj nową nazwę:</label>
            <div class="input-container">
              <input
                id="newExpenseName"
                name="newExpenseName"
                type="text"
                class="form-control mb-2 mt-2"
                required
              />
            </div>
          </div>

          <div class="form-group-modal mt-4 mb-4">
            <label>Wybierz kategorię do zmiany nazwy:</label>

            <select class="form-select" name="editExpanseName" aria-label="Default select example">
              {% for expenseCategory in expensesCategories %}
              <option value="{{ expenseCategory.id }}">{{ expenseCategory.name }}</option>
              {% endfor %}
            </select>
          </div>
      </div>

      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Zmień nazwę
          </button>
          
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

<!-- Modal edit payment method -->
<div class="modal fade" id="editPaymentMethod" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Edytuj nazwę metody płatności</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/editPaymentMethodName" method="post">

          <div class="form-group-modal mt-4 mb-4">
            <label>Podaj nową nazwę:</label>
            <div class="input-container">
              <input
                id="newPaymentName"
                name="newPaymentName"
                type="text"
                class="form-control mb-2 mt-2"
                required
              />
            </div>
          </div>

          <div class="form-group-modal mt-4 mb-4">
            <label>Wybierz kategorię do zmiany nazwy:</label>
            <div class="input-container">
              
            <ul>
              {% for paymentMethod in paymentMethods %}
              <div class="form-check">
                <input class="form-check-input" type="radio" value="{{ paymentMethod.id }}" name="editPaymentMethod" id="payment{{ paymentMethod.id }}">
                <label class="form-check-label" for="payment{{ paymentMethod.id }}">
                  {{ paymentMethod.name }}
                </label>
              </div>
              {% endfor %}
            </ul>
            
            </div>
          </div>
      </div>

      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Zmień nazwę
          </button>
          
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

<h2 class="header-section">Ustawienia</h2>

<div class="cards-container d-flex flex-wrap">

  <div class="card mb-4">
    <div class="card-header">
      <h3 class="header-balance">Edytuj nazwę kategorii</h3>
    </div>
    <div class="card-body d-flex flex-column flex-lg-row align-items-center justify-content-around justify-content-center">

      <button
        class="btn btn-primary my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#editIncomeName"
      >
        Przychody
      </button>

      <button
        class="btn btn-primary my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#editExpanseName"
      >
        Wydatki
      </button>

      <button
        class="btn btn-primary my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#editPaymentMethod"
      >
        Metoda płatności
      </button>

    </div>
  </div>

  <!-- Add new category -->

  <!-- Modal add new income category -->
<div class="modal fade" id="addNewIncomeCategory" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Dodaj nową kategorię przychodu</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/addNewIncomeCategory" method="post">

          <div class="form-group-modal mt-4 mb-4">
            <label>Podaj nazwę nowej kategorii przychodu:</label>
            <div class="input-container">
              <input
                id="newIncomeName"
                name="newIncomeName"
                type="text"
                class="form-control mb-2 mt-2"
                required
              />
            </div>
          </div>
      </div>
      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Dodaj
          </button>
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

 <!-- Modal add new expense category -->
 <div class="modal fade" id="addNewExpenseCategory" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Dodaj nową kategorię wydatku</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/addNewExpenseCategory" method="post">

          <div class="form-group-modal mt-4 mb-4">
            <label>Podaj nazwę nowej kategorii wydatku:</label>
            <div class="input-container">
              <input
                id="newExpenseName"
                name="newExpenseName"
                type="text"
                class="form-control mb-2 mt-2"
                required
              />
            </div>
          </div>
      </div>
      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Dodaj
          </button>
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

<!-- Modal add new payment method -->
<div class="modal fade" id="addNewPaymentMethod" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Dodaj metodę płatności</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/addNewPaymentMethod" method="post">

          <div class="form-group-modal mt-4 mb-4">
            <label>Podaj nazwę nowej metody płatności:</label>
            <div class="input-container">
              <input
                id="newPaymentMethod"
                name="newPaymentMethod"
                type="text"
                class="form-control mb-2 mt-2"
                required
              />
            </div>
          </div>
      </div>
      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Dodaj
          </button>
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

  <div class="card mb-4">
    <div class="card-header">
      <h3 class="header-incomes">Dodaj nową kategorię</h3>
    </div>
    <div class="card-body d-flex flex-column flex-lg-row align-items-center justify-content-around justify-content-center">

      <button
        class="btn btn-success my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#addNewIncomeCategory"
      >
        Przychody
      </button>

      <button
        class="btn btn-success my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#addNewExpenseCategory"
      >
        Wydatki
      </button>

      <button
        class="btn btn-success my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#addNewPaymentMethod"
      >
        Metoda płatności
      </button>

    </div>
  </div>

<!-- delete -->
<!-- Modal delete income category -->
<div class="modal fade" id="deleteIncomeCategory" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Usuń kategorię przychodu</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/deleteIncomeCategory" method="post">

          <div class="form-group-modal mt-4 mb-4">
            <label>Wybierz kategorię, którą chcesz usunąć:</label>
            <div class="input-container">
              
            <ul>
              {% for incomeCategory in incomesCategories %}
              <div class="form-check">
                <input class="form-check-input" type="radio" value="{{ incomeCategory.id }}" name="incomeCategoryToDelete" id="incomeDelete{{ incomeCategory.id }}">
                <label class="form-check-label" for="incomeDelete{{ incomeCategory.id }}">
                  {{ incomeCategory.name }}
                </label>
              </div>
              {% endfor %}
            </ul>
            
            </div>
          </div>

      </div>
      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Usuń
          </button>
          
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

<!-- Modal delete expense category -->
<div class="modal fade" id="deleteExpenseCategory" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Usuń kategorię wydatku</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/deleteExpenseCategory" method="post">

          <div class="form-group-modal mt-4 mb-4">
            <label>Wybierz kategorię, którą chcesz usunąć:</label>

            <select class="form-select" name="deleteExpanseCategory" aria-label="Default select example">
              {% for expenseCategory in expensesCategories %}
              <option value="{{ expenseCategory.id }}">{{ expenseCategory.name }}</option>
              {% endfor %}
            </select>
          </div>
      </div>

      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Usuń
          </button>
          
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

<!-- Modal delete payment method -->
<div class="modal fade" id="deletePaymentMethod" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Usuń metodę płatności</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/deletePaymentMethod" method="post">

          <div class="form-group-modal mt-4 mb-4">
            <label>Wybierz metodę płatności, którą chcesz usunąć:</label>
            <div class="input-container">
              
            <ul>
              {% for paymentMethod in paymentMethods %}
              <div class="form-check">
                <input class="form-check-input" type="radio" value="{{ paymentMethod.id }}" name="deletePaymentMethod" id="paymentDelete{{ paymentMethod.id }}">
                <label class="form-check-label" for="paymentDelete{{ paymentMethod.id }}">
                  {{ paymentMethod.name }}
                </label>
              </div>
              {% endfor %}
            </ul>
            
            </div>
          </div>
      </div>

      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Usuń
          </button>
          
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

  <div class="card mb-4">
    <div class="card-header">
      <h3 class="header-expenses">Usuń kategorię</h3>
    </div>
    <div class="card-body d-flex flex-column flex-lg-row align-items-center justify-content-around justify-content-center">

      <button
        class="btn btn-danger me-3 my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#deleteIncomeCategory"
      >
        Przychody
      </button>

      <button
        class="btn btn-danger me-3 my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#deleteExpenseCategory"
      >
        Wydatki
      </button>

      <button
        class="btn btn-danger my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#deletePaymentMethod"
      >
        Metoda płatności
      </button>

    </div>
  </div>

<!-- Edit user data -->
<!-- Modal edit user name -->
<div class="modal fade" id="editUserName" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Edytuj imię użytkownika</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/editUserName" method="post">

          <div class="form-group-modal mt-4 mb-4">
            <label>Podaj nowe imię:</label>
            <div class="input-container">
              <input
                id="newUserName"
                name="newUserName"
                type="text"
                class="form-control mb-2 mt-2"
                required
              />
            </div>
          </div>

      </div>
      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Zmień imię
          </button>
          
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

<!-- Modal edit user email -->
<div class="modal fade" id="editUserEmail" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Edytuj email użytkownika</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/editUserEmail" method="post">

          <div class="form-group-modal mt-4 mb-4">
            <label>Podaj nowy email:</label>
            <div class="input-container">
              <input
                id="newUserEmail"
                name="newUserEmail"
                type="text"
                class="form-control mb-2 mt-2"
                required
              />
            </div>
          </div>

      </div>
      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Zmień email
          </button>
          
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

<!-- Modal edit user password -->
<div class="modal fade" id="editUserPassword" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Edytuj hasło użytkownika</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">

        <form action="/settings/editUserPassword" method="post" id="formEditUserPassword">

          <div class="form-group-modal mt-4 mb-4">
            <label>Podaj nowe hasło:</label>
            <div class="input-container">
              <input
                id="newUserPassword"
                name="newUserPassword"
                type="password"
                class="form-control mb-2 mt-2"
                required
              />
              <div class="input-group-append">
                <span onclick="password_show_hide();">
                  <i class="fas fa-eye eye-icon" id="show_eye"></i>
                  <i
                    class="fas fa-eye-slash d-none eye-icon"
                    id="hide_eye"
                  ></i
                ></span>
              </div>
            </div>
            <small id="errornewUserPassword"></small>
            <small class="text-danger">{{ user.errors.password }}</small>
          </div>

      </div>
      <div class="modal-footer">
        <div class="btn-toolbar justify-content-left mb-3">
          <button type="submit" class="btn-group btn btn-success">
            Zmień hasło
          </button>
          
        </div>
      </div>
     </form>
    </div>
  </div>
</div>

  <div class="card mb-4">
    <div class="card-header">
      <h3 class="header-balance">Edytuj dane użytkownika</h3>
    </div>
    <div class="card-body d-flex flex-column flex-lg-row align-items-center justify-content-around justify-content-center">

      <button
        class="btn btn-primary my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#editUserName"
      >
        Imię
      </button>

      <button
        class="btn btn-primary my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#editUserEmail"
      >
        Email
      </button>

      <button
        class="btn btn-primary my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#editUserPassword"
      >
        Hasło
      </button>

    </div>
  </div>

  <div class="card mb-4">
    <div class="card-header">
      <h3 class="header-expenses">Usuń konto użytkownika</h3>
    </div>
    <div class="card-body d-flex flex-column flex-lg-row align-items-center justify-content-around justify-content-center">

      <button
        class="btn btn-danger my-2"
        type="button"
        aria-haspopup="true"
        aria-expanded="false"
        data-bs-toggle="modal" 
        data-bs-target="#editIncomeName"
      >
        Usuń swoje konto
      </button>
    </div>
  </div>

</div>

{% else %}

<section class="h-100 login-page-form">
  <div class="container py-5 h-100">
    <div
      class="row d-flex align-items-center justify-content-center h-100"
      id="accessDeniedMessage"
    >
      <h1><br />Strona dostępna tylko dla zalogowanych użytkowników!</h1>

      <p>
        <br /><br />
        Aby zacząć zarządzać swoim budżetem...<br /><br />
      </p>
    </div>
    <div class="d-flex align-items-center justify-content-center">
      <p class="my-5 me-2 mr-3"><b>Przejdź do strony logowania</b></p>
      <a href="/login" type="button" class="btn btn-primary"> Zaloguj się </a>
    </div>
    <div class="d-flex align-items-center justify-content-center">
      <p class="my-2 me-2 mr-3"><b>Jeśli nie masz jeszcze konta</b></p>
      <a href="/signup/new" type="button" class="btn btn-success">
        Zarejestruj się
      </a>
    </div>
  </div>
</section>

{% endif %} {% endblock %}
